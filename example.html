<script>
var module = {};
var exports = module.exports = {};
var process = {};
</script>

<script src="route.js"></script>

<script>
var router;

function refreshRouter(){
	router = new Router;
	document.getElementById('templates').value.split('\n').forEach(function(v){
		console.log(v);
		router.addTemplate(v.trim());
	});
}

function refreshResults(){
	var input = document.getElementById('test').value;
	var out = document.getElementById('result');
	var results = router.resolveURI(input);
	var result = results;
	if(result){
		out.innerText = result.template+'\n'+(result.argument||'')+'\n'+JSON.stringify(result.data, null, '\t');
	}else{
		out.innerText = 'Not Found';
	}
}

function alot(){
	router = new Router;
	var pieces = [
		['http://', 'https://'],
		['', 'www.', 'subdomain.', 'users.', 'status.', 'about.', 'news.'],
		['google','youtube', 'facebook', 'bidau', 'wikipedia', 'yahoo', 'qq',
			'taobao', 'twitter', 'amazon', 'tmall', 'souhu', 'live', 'vk', 'instagram',
		 	'linkedin', 'gmail', 'netflix', 't', 'ebay', 'pornhub', 'bing',
		 	'msn', 'imgur', 'reddit', 'microsoft', 'twitch', 'tumblr', 'slashdot', 'ycombinator',
			'github', 'cnn', 'foxnews', 'deviantart'
		],
		['.'],
		['com', 'org', 'net', 'co', 'io', 'xyz', 'luxury', 'jp', 'cn', 'tv'],
		['/', '/index', '/page/{id}', '/user/{id}', '/blog/{yyyy}/{mm}/{dd}/{slug}', '/~{user}', '/listing/{id}', '/cart', '/status','/path{/path*}'],
		['', '.html', '.json', '.txt', '.xml']
	];
	var patterns = pieces.reduce(function(state, list){
		var copy = [];
		var domains = state.forEach(function(base){
			list.forEach(function(segment){
				copy.push(base+segment);
			})
		});
		return copy;
	}, [''])
	patterns.forEach(function(template){
		router.addTemplate(template);
	});
	console.log('Added '+patterns.length+' templates');
}
	
window.onload = function(){
	document.getElementById('templates').onchange = refreshRouter;
	document.getElementById('test').onchange = refreshResults;
	document.getElementById('test').onkeyup = refreshResults;
}

</script>
<style>
	textarea, input {
		width: 100%;
	}
</style>

<div><textarea id="templates"></textarea></div>
<div><input type="text" id="test" /></div>
<pre id="result"></pre>